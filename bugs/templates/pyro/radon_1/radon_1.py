import pyro, numpy as np, torch, pyro.distributions   as dist, torch.nn as nn
from pyro.optim import Adam
import torch.distributions.constraints as constraints
from pyro.infer import SVI
if pyro.__version__ > '0.1.2': from pyro.infer import Trace_ELBO
from pyro.contrib.autoguide import *
import math
def amb(x):
    return x.data.numpy().tolist() if isinstance(x, torch.Tensor) else x
y= np.array([0.788457360364, 0.788457360364, 1.06471073699, 0.0, 1.13140211149, 0.916290731874, 0.405465108108, 0.0, -0.356674943939, 0.182321556794, 0.182321556794, 0.262364264467, 0.336472236621, -0.916290731874, 0.0953101798043, 1.50407739678, 0.262364264467, 0.741937344729, 1.77495235091, 1.19392246847, 0.587786664902, 1.68639895357, 1.8405496334, 0.641853886172, 1.88706964903, 1.13140211149, 1.91692261218, 1.94591014906, 2.04122032886, 1.64865862559, 1.50407739678, 1.48160454092, 1.02961941718, 2.09186406168, 0.470003629246, 1.43508452529, 1.68639895357, 1.38629436112, 0.832909122935, 1.06471073699, 0.336472236621, 1.19392246847, 1.06471073699, 0.587786664902, -1.60943791243, 0.875468737354, 0.0953101798043, 0.788457360364, -0.510825623766, 0.530628251062, 1.06471073699, 0.788457360364, 0.530628251062, 0.336472236621, 0.641853886172, 0.587786664902, 0.182321556794, 1.4586150227, 1.50407739678, 1.8405496334, 1.5260563035, 1.74046617484, 0.788457360364, -0.916290731874, 1.5260563035, 1.48160454092, 1.88706964903, 0.99325177301, 1.06471073699, 1.06471073699, 1.97408102602, 1.60943791243, 0.955511445027, 1.60943791243, 2.56494935746, 1.97408102602, 1.91692261218, 2.54944517093, 1.75785791755, 2.25129179861, 1.79175946923, 1.33500106673, 2.66025953727, 0.587786664902, 1.9315214116, 1.54756250872, 2.25129179861, 0.916290731874, 1.9021075264, 1.38629436112, 2.31253542385, 0.788457360364, 0.587786664902, 1.22377543162, 1.72276659774, 1.4586150227, 1.36097655314, 0.262364264467, 1.43508452529, -0.223143551314, 0.69314718056, 0.470003629246, 2.55722731137, 2.68784749378, 1.54756250872, 2.26176309847, -2.30258509299, 1.30833281965, 2.00148000021, 0.641853886172, 1.66770682056, 1.38629436112, 2.04122032886, 0.336472236621, 2.30258509299, 2.24070968928, -0.223143551314, 1.48160454092, 1.60943791243, 0.741937344729, 0.530628251062, 2.09186406168, -0.105360515658, 2.55722731137, 0.955511445027, 1.2527629685, 3.28091121579, 0.405465108108, 2.56494935746, 2.17475172148, 2.97041446557, 0.916290731874, 2.19722457734, 2.57261223021, 1.28093384546, 1.9315214116, 1.56861591791, 1.22377543162, -0.105360515658, 1.22377543162, 0.99325177301, 0.336472236621, 1.91692261218, 2.40694510832, -2.30258509299, 0.916290731874, 0.587786664902, 0.470003629246, 0.0, -0.105360515658, 1.06471073699, 1.48160454092, 0.405465108108, 1.41098697371, 0.916290731874, 1.9021075264, 1.4586150227, 1.70474809224, 1.28093384546, 1.02961941718, 2.68102152871, 1.9021075264, 2.07944154168, 0.955511445027, 1.02961941718, 1.48160454092, 0.530628251062, 0.69314718056, 0.69314718056, 0.405465108108, 2.26176309847, 2.09186406168, 1.2527629685, -0.223143551314, 1.62924053973, 1.16315080981, 2.37954613413, 2.10413415427, 1.8405496334, 1.56861591791, 1.79175946923, 0.0953101798043, 2.16332302566, 2.17475172148, 1.91692261218, 0.832909122935, 0.470003629246, 1.02961941718, 1.8718021769, 0.530628251062, 1.5260563035, 1.19392246847, 1.48160454092, 3.05400118168, 2.20827441352, -0.105360515658, 1.58923520512, 1.60943791243, 0.0953101798043, 2.02814824729, 1.68639895357, 1.28093384546, 1.58923520512, 1.54756250872, 0.336472236621, 1.22377543162, 1.43508452529, 0.916290731874, 0.336472236621, 0.336472236621, 0.641853886172, 1.56861591791, 0.336472236621, 1.33500106673, 2.17475172148, 1.4586150227, 1.48160454092, 1.50407739678, 0.788457360364, -0.69314718056, 1.75785791755, 1.68639895357, 1.97408102602, 1.74046617484, 2.00148000021, 1.56861591791, 1.91692261218, 1.85629799037, 1.30833281965, 1.70474809224, 2.0541237337, 1.48160454092, 0.99325177301, 1.22377543162, 1.43508452529, 0.832909122935, 0.262364264467, 1.64865862559, -2.30258509299, 0.916290731874, 1.16315080981, 1.16315080981, 2.26176309847, 1.43508452529, 2.19722457734, 1.8405496334, 3.48431228837, 2.58021682959, 0.788457360364, 1.72276659774, 2.66025953727, 1.9315214116, 2.02814824729, 2.28238238568, 0.955511445027, 3.77276093809, 1.58923520512, 1.58923520512, 1.2527629685, 1.56861591791, 1.72276659774, 1.2527629685, 1.36097655314, 1.9021075264, 2.06686275947, 1.19392246847, 0.741937344729, 0.470003629246, 1.38629436112, 0.587786664902, 0.916290731874, 2.4159137783, 0.955511445027, 1.36097655314, 2.00148000021, 0.262364264467, -0.105360515658, -0.916290731874, 0.916290731874, 1.79175946923, 0.69314718056, 1.68639895357, 1.09861228867, 1.06471073699, 1.70474809224, 1.41098697371, 1.36097655314, 2.70136121295, 1.97408102602, 0.832909122935, 1.02961941718, 1.48160454092, 0.405465108108, 2.15176220326, 1.72276659774, 2.15176220326, 1.33500106673, 0.587786664902, 0.641853886172, 1.70474809224, 0.916290731874, -0.223143551314, 0.741937344729, 1.02961941718, 1.36097655314, 1.4586150227, 1.54756250872, 1.02961941718, 1.41098697371, 0.470003629246, 1.4586150227, -0.356674943939, 1.70474809224, 1.19392246847, 1.70474809224, 0.916290731874, 0.99325177301, 2.12823170585, 1.19392246847, 1.16315080981, 2.15176220326, 0.530628251062, 1.74046617484, 2.56494935746, 0.99325177301, 1.54756250872, 1.72276659774, 2.62466859216, 2.02814824729, 1.74046617484, 1.5260563035, 2.02814824729, 0.955511445027, 1.50407739678, 1.77495235091, 0.788457360364, 0.875468737354, 1.38629436112, 1.5260563035, 1.5260563035, 2.38876278924, 2.02814824729, 1.09861228867, 0.405465108108, 0.470003629246, 2.80336038091, 1.13140211149, 1.62924053973, 1.58923520512, 1.79175946923, -0.105360515658, 0.587786664902, 1.36097655314, 1.72276659774, -0.916290731874, 0.955511445027, 1.28093384546, 1.82454929205, 3.16124671203, 1.36097655314, 1.06471073699, 1.09861228867, 1.54756250872, 1.09861228867, 1.43508452529, 1.33500106673, 1.09861228867, 1.4586150227, 1.06471073699, 1.22377543162, 2.1400661635, 2.19722457734, 1.56861591791, 1.28093384546, 0.788457360364, 1.02961941718, -0.223143551314, 0.405465108108, 1.5260563035, 1.30833281965, 1.28093384546, 1.09861228867, 0.788457360364, 0.641853886172, 0.955511445027, 0.587786664902, 0.875468737354, 1.4586150227, 0.955511445027, 0.0953101798043, 1.19392246847, 0.916290731874, 2.24070968928, 0.262364264467, 2.12823170585, 1.60943791243, 1.06471073699, 2.57261223021, 2.7278528284, 0.587786664902, 1.33500106673, 2.06686275947, 0.955511445027, 2.42480272572, 1.41098697371, 2.50959926238, 1.9021075264, 1.9315214116, 1.50407739678, -0.105360515658, 0.530628251062, 0.336472236621, 0.69314718056, 0.0, 0.0, 1.02961941718, 0.262364264467, 2.42480272572, 2.77258872224, 0.262364264467, 0.262364264467, 0.470003629246, -0.105360515658, 1.02961941718, -0.69314718056, 0.405465108108, 1.96009478405, -0.69314718056, 2.31253542385, 1.4586150227, 1.19392246847, 1.06471073699, 2.52572864431, 1.43508452529, 1.50407739678, 1.36097655314, 1.19392246847, 2.86220088093, 2.36085400112, 2.06686275947, 1.2527629685, 1.8718021769, 1.9315214116, 1.62924053973, 2.48490664979, 1.62924053973, 2.18605127674, 1.75785791755, 1.5260563035, 1.36097655314, 0.405465108108, 3.16968558068, -0.105360515658, 0.336472236621, 0.0953101798043, 1.02961941718, 3.87535902106, -0.105360515658, 2.1162555148, 1.41098697371, -0.69314718056, 1.9021075264, 2.01490302054, 2.21920348405, -0.69314718056, 0.405465108108, 2.33214389524, 1.36097655314, 0.587786664902, 2.29253475714, 0.832909122935, 1.48160454092, 1.02961941718, 0.0953101798043, 0.182321556794, 0.470003629246, 3.23474917402, -2.30258509299, 2.36085400112, 0.832909122935, 1.36097655314, 1.97408102602, 0.741937344729, 1.16315080981, -0.69314718056, 1.74046617484, 0.336472236621, 0.741937344729, 1.48160454092, 0.875468737354, 1.58923520512, 1.09861228867, 1.09861228867, 1.02961941718, 1.36097655314, 2.38876278924, 1.85629799037, 0.69314718056, 1.09861228867, 1.50407739678, 0.741937344729, 2.07944154168, 0.262364264467, 2.21920348405, 0.0953101798043, 2.36085400112, 3.17805383035, 2.20827441352, 2.4932054526, 2.09186406168, 2.37954613413, 1.43508452529, 2.75366071235, 1.68639895357, 1.82454929205, 2.27212588551, 2.09186406168, 0.470003629246, 0.470003629246, 1.85629799037, 1.48160454092, 2.4159137783, 2.30258509299, 1.50407739678, 2.07944154168, 0.832909122935, 1.16315080981, 1.60943791243, 1.41098697371, 0.0953101798043, 0.69314718056, 0.0953101798043, 1.06471073699, 0.741937344729, 2.0541237337, 1.33500106673, 0.916290731874, 1.06471073699, 0.530628251062, 0.916290731874, 2.24070968928, -0.510825623766, 0.99325177301, 0.0953101798043, 0.741937344729, 2.48490664979, 2.53369681396, 1.16315080981, 1.43508452529, 1.33500106673, 1.30833281965, 1.75785791755, -1.20397280433, 1.41098697371, 1.02961941718, 0.641853886172, 0.182321556794, 0.182321556794, 0.405465108108, 2.24070968928, 0.530628251062, 2.4932054526, 1.4586150227, 1.9315214116, 0.336472236621, 0.916290731874, 2.26176309847, 1.33500106673, 1.22377543162, 1.91692261218, 1.28093384546, 0.788457360364, 0.955511445027, 0.741937344729, 1.94591014906, 0.182321556794, 1.33500106673, 1.2527629685, 1.43508452529, 0.470003629246, 1.02961941718, 2.15176220326, 1.82454929205, 1.64865862559, 0.99325177301, 0.182321556794, 1.2527629685, 1.70474809224, 2.31253542385, 1.70474809224, 0.182321556794, 1.58923520512, 1.38629436112, 1.2527629685, 0.916290731874, 0.182321556794, 0.99325177301, 0.530628251062, 1.13140211149, -0.356674943939, 0.0, 0.641853886172, 1.33500106673, 2.18605127674, 2.00148000021, 3.03013370027, 1.79175946923, 0.741937344729, 1.75785791755, 2.27212588551, 1.85629799037, 1.5260563035, 1.72276659774, 2.94443897917, 0.875468737354, 1.09861228867, 1.62924053973, 2.04122032886, 2.09186406168, 1.54756250872, 2.12823170585, 0.470003629246, 1.79175946923, 0.0953101798043, 2.4336133554, 1.4586150227, 1.28093384546, 2.33214389524, 1.22377543162, 1.13140211149, 1.28093384546, 0.99325177301, 1.38629436112, 0.182321556794, 0.530628251062, 1.43508452529, 2.96010509591, 2.20827441352, 0.69314718056, 2.4336133554, 2.32238772029, 0.741937344729, 0.182321556794, 1.16315080981, 0.69314718056, 1.4586150227, 0.788457360364, 1.68639895357, 3.22684399452, 1.62924053973, 0.832909122935, 1.16315080981, 0.916290731874, 1.02961941718, 1.13140211149, 0.470003629246, 1.54756250872, 1.38629436112, 1.60943791243, 0.405465108108, 1.56861591791, -0.223143551314, -0.69314718056, 0.875468737354, 0.832909122935, 1.5260563035, 2.3978952728, 2.70136121295, 2.15176220326, 1.50407739678, 0.405465108108, 1.36097655314, 0.587786664902, 0.470003629246, -0.69314718056, -0.916290731874, -0.69314718056, 2.16332302566, 0.470003629246, 0.336472236621, 2.16332302566, 2.40694510832, 0.405465108108, 0.0953101798043, -0.105360515658, -0.356674943939, 1.43508452529, 1.22377543162, 0.741937344729, 1.06471073699, 0.587786664902, 0.587786664902, 0.875468737354, 0.530628251062, -0.223143551314, 2.4595888418, 0.587786664902, 1.02961941718, 1.2527629685, 1.28093384546, 1.2527629685, 1.09861228867, 1.16315080981, 1.13140211149, 1.19392246847, 0.530628251062, 1.72276659774, 1.22377543162, 0.405465108108, 3.47196645255, 0.0953101798043, 0.741937344729, -0.223143551314, 0.405465108108, 0.262364264467, 1.13140211149, 1.97408102602, 0.336472236621, 0.262364264467, 0.405465108108, 1.60943791243, 0.832909122935, 0.875468737354, 0.182321556794, 1.68639895357, 0.0953101798043, 0.336472236621, 1.97408102602, 0.0953101798043, 1.19392246847, 1.16315080981, 0.405465108108, 1.28093384546, -0.223143551314, 0.470003629246, 0.336472236621, 0.99325177301, 1.19392246847, -0.105360515658, -0.510825623766, 0.69314718056, 0.641853886172, -0.105360515658, 1.68639895357, 0.405465108108, 1.13140211149, 0.587786664902, -0.105360515658, 1.19392246847, 0.530628251062, 1.13140211149, -0.356674943939, 1.4586150227, 0.336472236621, 0.587786664902, 0.405465108108, 0.788457360364, 0.875468737354, 0.99325177301, 0.530628251062, 0.0953101798043, 0.587786664902, -1.60943791243, 0.788457360364, 1.5260563035, 0.741937344729, 0.69314718056, -0.356674943939, 1.85629799037, 1.09861228867, 0.69314718056, -0.105360515658, 1.19392246847, 0.587786664902, 0.587786664902, 0.788457360364, 1.4586150227, 2.01490302054, 1.85629799037, 2.1162555148, 0.741937344729, 1.19392246847, 0.262364264467, 1.60943791243, 0.0, 1.94591014906, 1.74046617484, 2.31253542385, 1.88706964903, 0.955511445027, 1.19392246847, 0.405465108108, 1.60943791243, 2.00148000021, 2.67414864943, 0.587786664902, 2.00148000021, 0.955511445027, 1.30833281965, 0.641853886172, 0.788457360364, 1.60943791243, 1.98787434815, 1.30833281965, 1.06471073699, 1.48160454092, 2.12823170585, 1.62924053973, 1.28093384546, 0.405465108108, 2.15176220326, 2.36085400112, 2.07944154168, 1.50407739678, 1.09861228867, 0.875468737354, 0.405465108108, 1.56861591791, 1.91692261218, 0.741937344729, 1.79175946923, 1.06471073699, 1.9021075264, 2.96010509591, 1.38629436112, 1.77495235091, 2.19722457734, 2.12823170585, 0.0953101798043, 1.13140211149, 2.44234703537, 2.26176309847, 1.06471073699, -0.356674943939, 1.16315080981, 1.54756250872, 1.56861591791, -0.916290731874, 2.23001440016, 0.530628251062, -0.105360515658, 2.32238772029, 2.04122032886, 0.788457360364, 1.8718021769, 2.50143595174, 1.5260563035, 1.82454929205, 1.8718021769, 1.02961941718, 0.641853886172, 0.182321556794, 0.875468737354, 0.0, 0.182321556794, 0.470003629246, -0.223143551314, 0.530628251062, 1.54756250872, 0.530628251062, 1.19392246847, -0.223143551314, 2.28238238568, 1.66770682056, 2.1400661635, 0.641853886172, 1.88706964903, 1.33500106673, 1.77495235091, 1.58923520512, 0.916290731874, 2.37024374147, 0.875468737354, 0.741937344729, 1.54756250872, 1.30833281965, 2.59525470696, 1.06471073699, 1.4586150227, 1.33500106673, 0.587786664902, 0.405465108108, 0.587786664902, 0.262364264467, 1.88706964903, 3.01553490085, 1.79175946923, 2.62466859216, 2.32238772029, 1.74046617484, 2.23001440016, 1.22377543162, 1.41098697371, 2.45100509811, 1.97408102602, 1.54756250872, 0.587786664902, -0.356674943939, 1.54756250872, 2.32238772029, 2.42480272572, 2.02814824729, 2.46809953147, -0.69314718056, 1.9021075264, 1.66770682056, 1.13140211149, 0.741937344729, 1.98787434815, 1.62924053973, 0.788457360364, 0.832909122935, 2.76631910923, 2.25129179861, 1.85629799037, 1.50407739678, 1.60943791243, 1.30833281965, 1.06471073699], dtype=np.float32).reshape(919,1)
y=torch.tensor(y)
x= np.array([1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0], dtype=np.float32).reshape(919,1)
x=torch.tensor(x)
J=85
J=torch.tensor(J)
county= np.array([1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 29, 29, 29, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 32, 32, 32, 32, 33, 33, 33, 33, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 36, 36, 37, 37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 38, 38, 39, 39, 39, 39, 39, 40, 40, 40, 40, 41, 41, 41, 41, 41, 41, 41, 41, 42, 43, 43, 43, 43, 43, 43, 43, 43, 43, 44, 44, 44, 44, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 46, 46, 46, 46, 46, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48, 48, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 50, 51, 51, 51, 51, 52, 52, 52, 53, 53, 53, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 55, 55, 55, 55, 55, 55, 55, 55, 56, 56, 56, 57, 57, 57, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 59, 60, 60, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 61, 62, 62, 62, 62, 62, 63, 63, 63, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 65, 65, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 66, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 67, 68, 68, 68, 68, 68, 68, 68, 68, 69, 69, 69, 69, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 70, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 71, 72, 72, 72, 72, 72, 72, 72, 72, 72, 72, 73, 73, 74, 74, 74, 74, 75, 75, 75, 76, 76, 76, 76, 77, 77, 77, 77, 77, 77, 77, 78, 78, 78, 78, 78, 79, 79, 79, 79, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 81, 81, 81, 82, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 84, 85, 85], dtype=np.int64).reshape(919,1)
county=torch.tensor(county)
N=919
N=torch.tensor(N)
def model(y,x,J,county,N):
    sigma_y = pyro.sample('sigma_y'.format(''), dist.Normal(torch.tensor(1234.0)*torch.ones([amb(1)]),torch.tensor(1234.0)*torch.ones([amb(1)])))
    b = pyro.sample('b'.format(''), dist.Normal(torch.tensor(1234.0)*torch.ones([amb(1)]),torch.tensor(1234.0)*torch.ones([amb(1)])))
    sigma_a = pyro.sample('sigma_a'.format(''), dist.Normal(torch.tensor(1234.0)*torch.ones([amb(1)]),torch.tensor(1234.0)*torch.ones([amb(1)])))
    mu_a = pyro.sample('mu_a'.format(''), dist.Normal(torch.tensor(1234.0)*torch.ones([amb(1)]),torch.tensor(1234.0)*torch.ones([amb(1)])))
    with pyro.iarange('a_range_'.format(''), J):
        a = pyro.sample('a'.format(''), dist.Normal(mu_a*torch.ones([amb(J)]),sigma_a*torch.ones([amb(J)])))
    for n in range(1, N+1):
        pyro.sample('obs_{0}_100'.format(n), dist.Normal(a[county[n-1]-1]+b*x[n-1],sigma_y), obs=y[n-1])
    
def guide(y,x,J,county,N):
    arg_1 = pyro.param('arg_1', torch.ones((amb(1))))
    arg_2 = pyro.param('arg_2', torch.ones((amb(1))), constraint=constraints.positive)
    sigma_y = pyro.sample('sigma_y'.format(''), dist.Normal(arg_1,arg_2))
    arg_3 = pyro.param('arg_3', torch.ones((amb(1))))
    arg_4 = pyro.param('arg_4', torch.ones((amb(1))), constraint=constraints.positive)
    b = pyro.sample('b'.format(''), dist.Normal(arg_3,arg_4))
    arg_5 = pyro.param('arg_5', torch.ones((amb(1))), constraint=constraints.positive)
    arg_6 = pyro.param('arg_6', torch.ones((amb(1))), constraint=constraints.positive)
    sigma_a = pyro.sample('sigma_a'.format(''), dist.Gamma(arg_5,arg_6))
    arg_7 = pyro.param('arg_7', torch.ones((amb(1))))
    arg_8 = pyro.param('arg_8', torch.ones((amb(1))), constraint=constraints.positive)
    mu_a = pyro.sample('mu_a'.format(''), dist.Normal(arg_7,arg_8))
    arg_9 = pyro.param('arg_9', torch.ones((amb(J))))
    arg_10 = pyro.param('arg_10', torch.ones((amb(J))), constraint=constraints.positive)
    with pyro.iarange('a_prange'):
        a = pyro.sample('a'.format(''), dist.Normal(arg_9,arg_10))
    for n in range(1, N+1):
        pass
    
    pass
optim = Adam({'lr': 0.05})
svi = SVI(model, guide, optim, loss=Trace_ELBO() if pyro.__version__ > '0.1.2' else 'ELBO')
for i in range(1000):
    loss = svi.step(y,x,J,county,N)
    if ((i % 1000) == 0):
        print(loss)
for name in pyro.get_param_store().get_all_param_names():
    print(('{0} : {1}'.format(name, pyro.param(name).data.numpy())))
print('a_mean', np.array2string(dist.Normal(pyro.param('arg_9'), pyro.param('arg_10')).mean.detach().numpy(), separator=','))
print('sigma_y_mean', np.array2string(dist.Normal(pyro.param('arg_1'), pyro.param('arg_2')).mean.detach().numpy(), separator=','))
print('b_mean', np.array2string(dist.Normal(pyro.param('arg_3'), pyro.param('arg_4')).mean.detach().numpy(), separator=','))
print('sigma_a_mean', np.array2string(dist.Gamma(pyro.param('arg_5'), pyro.param('arg_6')).mean.detach().numpy(), separator=','))
print('mu_a_mean', np.array2string(dist.Normal(pyro.param('arg_7'), pyro.param('arg_8')).mean.detach().numpy(), separator=','))
